---
title: 2.私有链创建 
tags: 私有链
grammar_cjkRuby: true
---


### 创建步骤
1. 创建私有链文件夹：private
2. 定义创世JSON文件：genesis.json
{
  "config": {
        "chainId": 0,
        "homesteadBlock": 0,
        "eip155Block": 0,
        "eip158Block": 0
    },
  "alloc"      : {},
  "coinbase"   : "0x0000000000000000000000000000000000000000",
  "difficulty" : "0x20000",
  "extraData"  : "",
  "gasLimit"   : "0x2fefd8",
  "nonce"      : "0x0000000000000042",
  "mixhash"    : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "parentHash" : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "timestamp"  : "0x00"
}

3. 通过genesis.json生成创世块：geth --datadir data init genesis.json
4. 启动节点，进入控制台：geth –datadir data console
5. geth启动参数详解：
启动命令eg：geth --datadir "./db" --rpc --rpcaddr=0.0.0.0 --rpcport 8545 --rpccorsdomain " * " --rpcapi "eth,net,web3,personal,admin,shh,txpool,debug,miner" --nodiscover --maxpeers 30 --networkid 1981 --port 30303 --mine --minerthreads 1 --etherbase "0xcCE4c1093D63416Eb079BFfe50Dc9Ce590703c6B" console 2>>tail.log
    - --datadir ：区块链数据库存放位置
    - --rpc ：启动RPC通信，可以进行智能合约部署和调试
    - --rpcaddr=0.0.0.0 ：指定HTTP-RPC监听地址，默认localhost
    - --rpcport 8545 : 指定HTTP-RPC监听端口，默认8545
    - --rpccorsdomain " * "
    - --rpcapi ：允许连接的RPC客户端
    - --nodiscover ：关闭自动连接
    - --maxpeers 30 ：允许的最大连接数，默认25个
    - --networkid 1981 ：设置当前区块链中网络ID 为了区分不同的网络
    - --port 30303 
    - --mine ：开始挖矿，默认CPU挖矿
    - --minerthreads 1 ：挖矿的CPU线程数，默认是4
    - --etherbase ：矿工账号
    - console : 启动命令行，可以在geth中执行命令
6. 	控制台对象：比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。
    - eth：包含一些跟操作区块链相关的方法；
    - net：包含一些查看p2p网络状态的方法；
    - admin：包含一些与管理节点相关的方法；
    - miner：包含启动&停止挖矿的一些方法；
    - personal：主要包含一些管理账户的方法；
    - txpool：包含一些查看交易内存池的方法；
    - web3：包含了以上对象，还包含一些单位换算的方法。
 7. 控制台对象常用命令：
    - personal.newAccount("密码")：创建账户
    - personal.unlockAccount("账户")：解锁账户
    - eth.accounts：枚举系统中的账户
    - eth.accounts[0]: 查看系统中下标是0的账户 
    - eth.getBalance("账户")：查看账户余额，返回值的单位是 Wei（1 ether = 10^18 Wei）
    - eth.coinbase：查看矿工地址，默认第一个账户位矿工账户
    - miner.setEtherbase(eth.accounts[1]) ：设置新的矿工账户
    - miner.start()：开始挖矿
    - miner.stop()：停止挖矿；
    - web3.fromWei('21000000000000', 'ether')：Wei 换算成以太币；
    - web3.toWei(5,'ether')：以太币换算成 Wei；
    - 发送交易
      1.解锁账户 personal.unlockAccount(eth.accounts[0])
      2.发送交易 eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:web3.toWei(5,'ether')})
      3.如果没有挖矿，txpool.status可以看到本次交易中有一个待确认的交易，可以使用eth.getBlock("pending",true) 查看当前待确认交易
      4.开始挖矿：miner.start(1);admin.sleepBlocks(1);miner.stop();
    - eth.blockNumber：查看当前区块总数
    - eth.getBlock(4)：通过区块号查看区块

